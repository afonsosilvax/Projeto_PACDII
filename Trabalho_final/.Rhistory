Data$Datahora[which(is.na(Data$Estacao_ano) == TRUE)]
Data$Estacao_ano<- rep(NA,40209)
typeof(Data$Datahora)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2020-12-31" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
summary(is.na(Data$Estacao_ano))
summary(is.na(Data$Datahora))
Data$Datahora[which(is.na(Data$Estacao_ano) == TRUE)]
Data$Estacao_ano<- rep(NA,40209)
typeof(Data$Datahora)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2020-12-32" )]<- "Inverno"
Data$Estacao_ano<- rep(NA,40209)
typeof(Data$Datahora)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2020-12-31" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
summary(is.na(Data$Estacao_ano))
summary(is.na(Data$Datahora))
Data$Datahora[which(is.na(Data$Estacao_ano) == TRUE)]
Data$Estacao_ano<- rep(NA,40209)
typeof(Data$Datahora)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
summary(is.na(Data$Estacao_ano))
summary(is.na(Data$Datahora))
Data$Datahora[which(is.na(Data$Estacao_ano) == TRUE)]
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
hist(Data$Estacao_ano, Prob = T)
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
barplot(Data$Estacao_ano, Prob = T)
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
barplot(Data$Estacao_ano)
as.factor(Data$Estacao_ano)
barplot(Data$Estacao_ano)
hist(Data$Estacao_ano)
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
as.factor(Data$Estacao_ano)
freq.rel<-table(Data$Estacao_ano)/length(Data$Estacao_ano)
hist(Data$Estacao_ano)
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
as.factor(Data$Estacao_ano)
freq.rel<-table(Data$Estacao_ano)/length(Data$Estacao_ano)
barplot(freq.rel)
freq.rel<-table(Data$Estacao_ano)/length(Data$Estacao_ano)
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
as.factor(Data$Estacao_ano)
freq.rel<-table(Data$Estacao_ano)/length(Data$Estacao_ano)
barplot(freq.rel)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
setwd("C:/Users/tomas/Downloads")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
# Remover tudo!
# Incluir as libraries de que necessita
library(VIM)
library(plyr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
# Remover tudo!
# Incluir as libraries de que necessita
library(VIM)
library(plyr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
knitr::opts_chunk$set(echo = TRUE)
# Remover tudo!
# Incluir as libraries de que necessita
library(VIM)
library(plyr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
summary(is.na(Data))
Data1<-Data[,c("Tempo Condução Continuada", "Tipo Veiculo", "Tipo Serviço", "Distrito")]
Data1<-kNN(Data1, variable = "Tempo Condução Continuada", k = 200)
summary(is.na(Data1))
Data1<- Data1[, c("Tempo Condução Continuada", "Tipo Veiculo", "Tipo Serviço", "Distrito")]
Data$`Tempo Condução Continuada`<-Data1$`Tempo Condução Continuada`
summary(Data$`Tempo Condução Continuada`)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
freq.rel<-table(Data$Estacao_ano)/length(Data$Estacao_ano)
barplot(freq.rel)
summary(is.na(Data))
Data1<-Data[,c("Tempo Condução Continuada", "Tipo Veiculo", "Tipo Serviço", "Distrito")]
Data1<-kNN(Data1, variable = "Tempo Condução Continuada", k = 200)
summary(is.na(Data1))
Data1<- Data1[, c("Tempo Condução Continuada", "Tipo Veiculo", "Tipo Serviço", "Distrito")]
Data$`Tempo Condução Continuada`<-Data1$`Tempo Condução Continuada`
summary(Data$`Tempo Condução Continuada`)
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
freq.rel<-table(Data$Estacao_ano)/length(Data$Estacao_ano)
barplot(freq.rel)
View(Data)
# Remover tudo!
# Incluir as libraries de que necessita
library(VIM)
library(plyr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
library(psych)
library (corrplot)
library(ggplot2)
library(ggfortify)
library(lsr)# Cramer's V e Eta
library(factoextra)
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$Estacao_ano)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$Estacao_ano)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
Eta_
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$`Ano matricula`)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$Estacao_ano)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
Eta_
View(anova_)
cor(Data$`Lesões a 30 dias` ,Data$`Ano matricula`)
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,500),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,40000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(pt_SE<-round(prop.table(x,2)*100,1))
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","
dodgerblue4"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","
dodgerblue3"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","
red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","
red", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Income ~ Ethnicity, Credit)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$`Ano matricula`, Data)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$`Ano matricula`, Data)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
View(Data)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
rho<-cor.test(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`, method = 'spearman')
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
rho<-cor.test(x=Data$`Ano matricula`, y=Data$`Lesões a 30 dias`, method = 'spearman')
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Data$`Ano matricula` ~ Data$`Lesões a 30 dias`, Data)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Data$`Ano matricula` ~ Data$`Lesões a 30 dias`, Data)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
knitr::opts_chunk$set(echo = TRUE)
n <- 1000
x1 <- rgamma(n, 2, 2)
x2 <- rgamma(n, 2, 4)
s <- x1 + x2 #define a convolução
u <- runif(n)
k <- as.integer(u > 0.5) #vector de 0 e 1
x <- k * x1 + (1-k) * x2 #define a mistura
par(mfcol=c(1,2))
hist(s, prob=TRUE, xlim=c(0,5), ylim=c(0,1), main = "Soma de Gammas")
hist(x, prob=TRUE, xlim=c(0,5), ylim=c(0,1), main="Mistura de Gammas")
par(mfcol=c(1,1))
n <- 1000
x1 <- rgamma(n, 2, 2)
x2 <- rgamma(n, 2, 4)
s <- x1 + x2 #define a convolução
u <- runif(n)
k <- as.integer(u > 0.5) #vector de 0 e 1
x <- k * x1 + (1-k) * x2 #define a mistura
par(mfcol=c(1,2))
hist(s, prob=TRUE, xlim=c(0,5), ylim=c(0,1), main = "Soma de Gammas")
hist(x, prob=TRUE, xlim=c(0,5), ylim=c(0,1), main="Mistura de Gammas")
par(mfcol=c(1,1))
library(igraph)
grafo<-read.graph("C://Users/tomas/Documents/trab_links.txt", format = c('edgelist'), directed = F)
plot(grafo)
vcount(grafo)
ecount(grafo)
edge_density(grafo)
mean(degree(grafo,mode= "in"))
table(degree(grafo,mode="in"))
is_connected(grafo)
components(grafo)
assortativity_degree(grafo,directed=F)
mean_distance(grafo,directed=F)
diameter(grafo)
count_triangles(grafo)
sum(count_triangles(grafo))
deg <- degree(grafo,mode="total")
ht <- mean(deg*deg)/(mean(deg)^2)
ht
kc <- coreness(grafo,mode="all")
plot(grafo,vertex.size=kc*10,vertex.label=kc)
kc <- coreness(grafo,mode="all")
plot(grafo,vertex.size=kc*10,vertex.label=kc)
components(grafo)
comp_gig<-which.max(components(grafo)$csize == 496)
plot(comp_gig)
library(dplyr)
library(readxl)
library(tidyverse)
library(janitor)
library(here)
library(lubridate)
library(ggplot2)
library(ggplot2)
# Ler ficheiros
acidentes_2010 <- read_excel("acidentes-2010.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
setwd("C:/Users/tomas/Documents/Projeto_PACDII/Trabalho_final")
# Ler ficheiros
acidentes_2010 <- read_excel("acidentes-2010.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2011 <- read_excel("acidentes-2011.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2012 <- read_excel("acidentes-2012.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2013 <- read_excel("acidentes-2013.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2014 <- read_excel("acidentes-2014.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2015 <- read_excel("acidentes-2015.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2016 <- read_excel("acidentes-2016.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2017 <- read_excel("acidentes-2017.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2018 <- read_excel("acidentes-2018.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2019 <- read_excel("acidentes-2019.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
# Juntar todos os anos
acidentes <- rbind(acidentes_2010, acidentes_2011, acidentes_2012, acidentes_2013,
acidentes_2014, acidentes_2015, acidentes_2016, acidentes_2017,
acidentes_2018, acidentes_2019)
# Tratamento da coluna datahora
acidentes$datahora <- as_datetime(acidentes$datahora)
class(acidentes$datahora)
summary(acidentes$datahora)
# Passar para factor as variáveis que são character
acidentes <- acidentes %>% mutate_if(is.character, as.factor)
# Resumo do dataset
summary(acidentes)
glimpse(acidentes)
# Estudo dos NA's
summary(is.na(acidentes))
# Variáveis com alto teor em NA's
summary(acidentes$pov_proxima)
summary(acidentes$nome_arruamento)
summary(acidentes$km)
summary(acidentes$sentidos)
summary(acidentes$obras_arte) # túneis, pontes e estradas - substituir NA's por estradas
summary(acidentes$sinais)
View(acidentes)
View(acidentes)
