library(plyr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
# Remover tudo!
# Incluir as libraries de que necessita
library(VIM)
library(plyr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
knitr::opts_chunk$set(echo = TRUE)
# Remover tudo!
# Incluir as libraries de que necessita
library(VIM)
library(plyr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
summary(is.na(Data))
Data1<-Data[,c("Tempo Condução Continuada", "Tipo Veiculo", "Tipo Serviço", "Distrito")]
Data1<-kNN(Data1, variable = "Tempo Condução Continuada", k = 200)
summary(is.na(Data1))
Data1<- Data1[, c("Tempo Condução Continuada", "Tipo Veiculo", "Tipo Serviço", "Distrito")]
Data$`Tempo Condução Continuada`<-Data1$`Tempo Condução Continuada`
summary(Data$`Tempo Condução Continuada`)
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "latin1")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
Data <-read.csv("condutores.csv", header=TRUE, stringsAsFactors =T,sep=",",dec=",",check.names=F,na.strings=c("NA","NÃO DEFINIDO"),fileEncoding = "UTF-8")
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
freq.rel<-table(Data$Estacao_ano)/length(Data$Estacao_ano)
barplot(freq.rel)
summary(is.na(Data))
Data1<-Data[,c("Tempo Condução Continuada", "Tipo Veiculo", "Tipo Serviço", "Distrito")]
Data1<-kNN(Data1, variable = "Tempo Condução Continuada", k = 200)
summary(is.na(Data1))
Data1<- Data1[, c("Tempo Condução Continuada", "Tipo Veiculo", "Tipo Serviço", "Distrito")]
Data$`Tempo Condução Continuada`<-Data1$`Tempo Condução Continuada`
summary(Data$`Tempo Condução Continuada`)
Data$Estacao_ano<- rep(NA,40209)
Data$Datahora<- ymd_hms(Data$Datahora)
Data$Estacao_ano[which(Data$Datahora > "2020-3-22" & Data$Datahora <= "2020-6-20" )]<- "Primavera"
Data$Estacao_ano[which(Data$Datahora > "2020-6-20" & Data$Datahora <= "2020-9-22" )]<- "Verão"
Data$Estacao_ano[which(Data$Datahora > "2020-9-22" & Data$Datahora <= "2020-12-21" )]<- "Outono"
Data$Estacao_ano[which(Data$Datahora > "2020-12-21" & Data$Datahora <= "2021-1-1" )]<- "Inverno"
Data$Estacao_ano[which(Data$Datahora >= "2020-1-1" & Data$Datahora <= "2020-3-22" )]<- "Inverno"
freq.rel<-table(Data$Estacao_ano)/length(Data$Estacao_ano)
barplot(freq.rel)
View(Data)
# Remover tudo!
# Incluir as libraries de que necessita
library(VIM)
library(plyr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
library(psych)
library (corrplot)
library(ggplot2)
library(ggfortify)
library(lsr)# Cramer's V e Eta
library(factoextra)
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$Estacao_ano)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$Estacao_ano)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
Eta_
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$`Ano matricula`)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$Estacao_ano)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
Eta_
View(anova_)
cor(Data$`Lesões a 30 dias` ,Data$`Ano matricula`)
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,500),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,40000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(pt_SE<-round(prop.table(x,2)*100,1))
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","
dodgerblue4"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","
dodgerblue3"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","
red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","
red", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Income ~ Ethnicity, Credit)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$`Ano matricula`, Data)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Data$`Lesões a 30 dias` ~ Data$`Ano matricula`, Data)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
View(Data)
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
rho<-cor.test(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`, method = 'spearman')
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
rho<-cor.test(x=Data$`Ano matricula`, y=Data$`Lesões a 30 dias`, method = 'spearman')
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Data$`Ano matricula` ~ Data$`Lesões a 30 dias`, Data)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
coords <- table(Data$`Lesões a 30 dias`)
p<-barplot(coords, ylim=c(0,30000),main = "Frequencia",col="lightgrey")
text(x = p, y = coords, label = coords, cex = 0.8,pos = 3, col = "blue")
x<-table(Data$`Lesões a 30 dias`,Data$Estacao_ano)
(x_1<-round(prop.table(x,2)*100,1))
coords <- x_1
p<-barplot(x_1,beside=TRUE,legend.text = TRUE, ylim=c
(0,100), xlab="Estação",ylab="Lesão's %", col= c("dodgerblue3","green", "blue", "red"),args.legend = list(x = "topright",inset =
c(- 0.05, 0)))
text(x = p, y = coords, label = coords,cex = 0.8,pos =
1, col = "white")
cramersV(Data$`Lesões a 30 dias`,Data$Estacao_ano)
ggplot(Data, aes(x=Data$`Lesões a 30 dias`, y=Data$`Ano matricula`)) +
geom_violin(width=1,trim=FALSE)+
geom_boxplot(width=0.1, color="grey",
alpha=0.2)
anova_ <- aov (Data$`Ano matricula` ~ Data$`Lesões a 30 dias`, Data)
(Eta_ <- sqrt(etaSquared(anova_ )[,1]))
knitr::opts_chunk$set(echo = TRUE)
n <- 1000
x1 <- rgamma(n, 2, 2)
x2 <- rgamma(n, 2, 4)
s <- x1 + x2 #define a convolução
u <- runif(n)
k <- as.integer(u > 0.5) #vector de 0 e 1
x <- k * x1 + (1-k) * x2 #define a mistura
par(mfcol=c(1,2))
hist(s, prob=TRUE, xlim=c(0,5), ylim=c(0,1), main = "Soma de Gammas")
hist(x, prob=TRUE, xlim=c(0,5), ylim=c(0,1), main="Mistura de Gammas")
par(mfcol=c(1,1))
n <- 1000
x1 <- rgamma(n, 2, 2)
x2 <- rgamma(n, 2, 4)
s <- x1 + x2 #define a convolução
u <- runif(n)
k <- as.integer(u > 0.5) #vector de 0 e 1
x <- k * x1 + (1-k) * x2 #define a mistura
par(mfcol=c(1,2))
hist(s, prob=TRUE, xlim=c(0,5), ylim=c(0,1), main = "Soma de Gammas")
hist(x, prob=TRUE, xlim=c(0,5), ylim=c(0,1), main="Mistura de Gammas")
par(mfcol=c(1,1))
library(dplyr)
library(readxl)
library(tidyverse)
#install.packages("janitor")
library(janitor) # for datacleaning
library(here)
library(lubridate)
rm(list=ls()) # limpar variáveis
acidentes_2010 <- read_excel("acidentes-2010.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2011 <- read_excel("acidentes-2011.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2012 <- read_excel("acidentes-2012.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2013 <- read_excel("acidentes-2013.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2014 <- read_excel("acidentes-2014.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2015 <- read_excel("acidentes-2015.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2016 <- read_excel("acidentes-2016.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2017 <- read_excel("acidentes-2017.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2018 <- read_excel("acidentes-2018.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2019 <- read_excel("acidentes-2019.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes <- rbind(acidentes_2010, acidentes_2011, acidentes_2012, acidentes_2013,
acidentes_2014, acidentes_2015, acidentes_2016, acidentes_2017,
acidentes_2018, acidentes_2019)
setwd("C:/Users/tomas/Documents/Projeto_PACDII/Trabalho_final")
acidentes_2010 <- read_excel("acidentes-2010.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2011 <- read_excel("acidentes-2011.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2012 <- read_excel("acidentes-2012.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2013 <- read_excel("acidentes-2013.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2014 <- read_excel("acidentes-2014.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2015 <- read_excel("acidentes-2015.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2016 <- read_excel("acidentes-2016.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2017 <- read_excel("acidentes-2017.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2018 <- read_excel("acidentes-2018.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes_2019 <- read_excel("acidentes-2019.xlsx", sheet = 3, col_names = TRUE, na = "NÃO DEFINIDO"
, .name_repair = make_clean_names)
acidentes <- rbind(acidentes_2010, acidentes_2011, acidentes_2012, acidentes_2013,
acidentes_2014, acidentes_2015, acidentes_2016, acidentes_2017,
acidentes_2018, acidentes_2019)
#problema 1
problema1<-acidentes[,c(1,2)]
filtered_df <- problema1[format(df$timestamp, "%m-%d") == "25-12", ]
filtered_df <- problema1[format(problema1$datahora, "%m-%d") == "2512", ]
filtered_df <- problema1[format(problema1$datahora, "%m-%d") == "25-12", ]
View(problema1)
filtered_df <- problema1[format(problema1$datahora, "%m-%d") == "25:12", ]
# Tratamento das datas
acidentes$datahora <- as_datetime(acidentes$datahora)
class(acidentes$datahora)
summary(acidentes$datahora)
#problema 1
problema1<-acidentes[,c(1,2)]
filtered_df <- problema1[format(problema1$datahora, "%m-%d") == "25:12", ]
View(filtered_df)
filtered_df <- problema1[format(problema1$datahora, "%m:%d") == "25:12", ]
filtered_df <- problema1[format(problema1$datahora, "%m-%d") == "25-12", ]
library(ggplot2)
ggplot(problema1, aes(x = datahora)) +
geom_bar(stat = "count", fill = "skyblue") +
scale_x_datetime(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data e Hora", y = "Número de Acidentes")
problema1$ano_mes <- format(problema1$datahora, "%Y-%m")
View(problema1)
problema1$ano_mes <- format(problema1$datahora, "%m-%d")
View(problema1)
ggplot(problema1, aes(x = as.Date(datahora), group = 1)) +
geom_line(stat = "count", color = "skyblue") +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes")
ggplot(problema1, aes(x = dia_mes, group = 1)) +
geom_line(stat = "count", color = "skyblue") +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes")
ggplot(problema1, aes(x = problema1$dia_mes, group = 1)) +
geom_line(stat = "count", color = "skyblue") +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes")
filtered_df <- problema1[dia_mes = "12:25", ]
View(filtered_df)
filtered_df <- problema1[dia_mes = "12:25", ]
filtered_df <- problema1[dia_mes = "12-25", ]
filtered_df <- problema1[dia_mes == "12-25", ]
filtered_df <- problema1[problema1$dia_mes == "12-25", ]
problema1$dia_mes <- format(problema1$datahora, "%m-%d")
filtered_df <- problema1[problema1$dia_mes == "12-25", ]
View(problema1)
View(filtered_df)
ggplot(problema1, aes(x = dia_mes , group = 1)) +
geom_line(stat = "count", color = "skyblue") +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes")
ggplot(problema1, aes(x = as.Date(dia_mes) , group = 1)) +
geom_line(stat = "count", color = "skyblue") +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes")
ggplot(problema1, aes(x = as.Date(datahora) , group = 1)) +
geom_line(stat = "count", color = "skyblue") +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes")
filtered_df1 <- problema1[problema1$dia_mes == "7-30", ]
filtered_df1 <- problema1[problema1$dia_mes == "7-25", ]
View(problema1)
filtered_df1 <- problema1[problema1$dia_mes == "07-25", ]
View(acidentes)
#problema 1
problema1<-acidentes[,c(1,2,9)]
problema1$dia_mes <- format(problema1$datahora, "%m-%d")
filtered_df <- problema1[problema1$dia_mes == "12-25", ]
filtered_df1 <- problema1[problema1$dia_mes == "07-25", ]
View(filtered_df1)
View(acidentes)
View(filtered_df)
ggplot(problema1, aes(x = as.Date(datahora) , group = 1)) +
geom_line(stat = "count", color = "skyblue") +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes", xlab=c("2010,2011,2012,2013,2014,2015,2016,2017,2018,2019"))
ggplot(problema1, aes(x = as.Date(datahora) , group = 1)) +
geom_line(stat = "count", color = "skyblue") +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes", xlab=c("2010","2011","2012","2013","2014","2015","2016","2017","2018","2019"))
plot(filtered_df)
plot(filtered_df,filtered_df1)
View(filtered_df)
View(acidentes)
ggplot(problema1, aes(x = as.Date(datahora) , group = 1)) +
geom_line(stat = "count", color = "skyblue") +
labs(title = "Ocorrência de Acidentes ao Longo do Ano", x = "Data", y = "Número de Acidentes")
View(acidentes)
View(problema1)
nr_acidentes <- problema1 %>% group_by(problema1$dia_mes) %>% modify(count(problema1$dia_mes))
View(problema1)
df<-problema1[,1,4]
df<-problema1[,c(1,4)]
View(df)
nr_acidentes <- data.frame(dia = names(df), ocorrencias = as.vector(df))
View(nr_acidentes)
nr_acidentes <- problema1 %>% group_by(problema1$dia_mes) %>% summarise(n=n())
View(nr_acidentes)
nr_acidentes <- problema1 %>% group_by(problema1$dia_mes) %>% summarise(numero_acidentes=n())
View(nr_acidentes)
nr_acidentes <- problema1 %>% group_by(problema1$dia_mes) %>% mean(numero_acidentes=n())
nr_acidentes <- problema1 %>% group_by(problema1$dia_mes) %>% summarise(numero_acidentes=n())
nr_acidentes$numero_acidentes<-nr_acidentes$numero_acidentes / 10
View(nr_acidentes)
plot(nr_acidentes)
ggplot(nr_acidentes, aes(x=nr_acidentes$`problema1$dia_mes`)) +
labs(title = "Ocorrência de Acidentes ao Longo de um ano", x = "Dias", y = "Número de Acidentes")
ggplot(nr_acidentes, aes(x=nr_acidentes$`problema1$dia_mes`, y=nr_acidentes$numero_acidentes)) +
labs(title = "Ocorrência de Acidentes ao Longo de um ano", x = "Dias", y = "Número de Acidentes")
ggplot(nr_acidentes, aes(x =datahora, y = numero_acidentes, group = 1)) +
geom_line(color = "skyblue") +
geom_point(color = "red") +
labs(title = "Evolução do Número de Acidentes ao Longo dos Dias", x = "Data", y = "Número de Acidentes")
ggplot(nr_acidentes, aes(x =`problema1$dia_mes`, y = numero_acidentes, group = 1)) +
geom_line(color = "skyblue") +
geom_point(color = "red") +
labs(title = "Evolução do Número de Acidentes ao Longo dos Dias", x = "Data", y = "Número de Acidentes")
library(xts)
nr_acidentes.to_monthly
to.monthly(nr_acidentes)
View(nr_acidentes)
View(problema1)
to.monthly(problema1)
to.monthly(problema1$datahora)
?convert_to_date
convert_to_date(problema1$datahora)
to.monthly(convert_to_date(problema1$datahora))
?to.monthly
as.xts(problema1)
as.xts(problema1$datahora)
to.monthly(as.xts(problema1$datahora))
